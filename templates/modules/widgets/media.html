<th:block th:fragment="media(media,iterStat,size)">
  <img
    th:if="${#strings.equals(media.type,'PHOTO')}"
    data-fancybox="images"
    class="load h-[100px] w-full transform-gpu break-inside-avoid rounded-md object-cover"
    th:classappend="${size==1}?'!h-full':(${iterStat.first && size == 3}?'media-large':'')"
    th:src="${media.url}"
    th:srcset="|${thumbnail.gen(media.url, 's')} 400w,
                                ${thumbnail.gen(media.url, 'm')} 800w,
                                ${thumbnail.gen(media.url, 'l')} 1200w|"
    sizes="(max-width: 1200px) 100vw, 1200px"
  />
  <div th:if="${#strings.equals(media.type,'VIDEO')}" x-data="{openVideoModal:false}" class="aspect-1 relative">
    <video th:src="${media.url}" class="rounded-xl border border-zinc-200 object-cover dark:border-zinc-700/40"></video>
    <div
      th:if="${#strings.equals(media.type,'VIDEO')}"
      class="absolute inset-0 flex size-full cursor-pointer items-center justify-center rounded-lg bg-white/10 transition-all dark:bg-black/10"
      @click="openVideoModal = true"
    >
      <svg
        t="1755697451702"
        class="size-8"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="6550"
        width="200"
        height="200"
      >
        <path
          d="M512 24C242.48 24 24 242.48 24 512s218.48 488 488 488 488-218.48 488-488S781.52 24 512 24z m198.992 538.688L449.92 713.408c-48.288 27.872-87.792 5.072-87.792-50.688V361.28c0-55.76 39.504-78.56 87.792-50.688l261.072 150.72c48.288 27.872 48.288 73.504 0 101.376z"
          class="fill-zinc-300 dark:fill-zinc-400"
          p-id="6551"
        ></path>
      </svg>
    </div>
    <template x-teleport="body">
      <div>
        <div
          class="fixed inset-0 z-50 bg-zinc-800/40 backdrop-blur dark:bg-black/80"
          aria-hidden="true"
          x-show="openVideoModal"
          x-transition:enter="ease-in-out duration-300"
          x-transition:enter-start="opacity-0"
          x-transition:enter-end="opacity-100"
          x-transition:leave="ease-in-out duration-300"
          x-transition:leave-start="opacity-100"
          x-transition:leave-end="opacity-0"
        ></div>
        <div
          class="fixed inset-0 z-50 overflow-y-auto"
          tabindex="-1"
          x-show="openVideoModal"
          x-transition:enter="ease-out duration-200"
          x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
          x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
          x-transition:leave="ease-in duration-100"
          x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
          x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
        >
          <div class="flex min-h-full flex-col items-center justify-center p-4 text-center sm:p-0">
            <div
              @click.outside="openVideoModal = false"
              class="origin-top rounded-3xl bg-gradient-to-b from-zinc-100/75 to-white p-4 ring-1 ring-zinc-900/5 sm:w-full sm:max-w-xl dark:from-zinc-900/50 dark:to-zinc-900 dark:ring-zinc-800"
            >
              <video th:src="${media.url}" class="w-full rounded-xl" controls></video>
            </div>
            <div>
              <div
                @click="openVideoModal = false"
                class="group mt-4 inline-flex cursor-pointer items-center justify-center rounded-full bg-gradient-to-b from-zinc-100/75 to-white p-1.5 ring-1 ring-zinc-900/5 dark:from-zinc-900/50 dark:to-zinc-900 dark:ring-zinc-800"
              >
                <i
                  class="iconfont icon-close leading-[1] text-zinc-600 group-hover:text-zinc-800 dark:group-hover:text-zinc-100"
                ></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </template>
  </div>
</th:block>
